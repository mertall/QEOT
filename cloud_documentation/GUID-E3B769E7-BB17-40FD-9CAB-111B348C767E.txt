VMware DocsMyLibrarytimesMyLibraryMyLibraryclose-lineFor the node deployment process to deploy your node successfully, you must configure your firewalls to allow Horizon Cloud to access the Domain Name Service (DNS) addresses it needs. In addition, your DNS must resolve specific names as described in this topic. Then, after the node is successfully deployed, specific ports and protocols are required for ongoing Horizon Cloud operations. Horizon CloudHorizon CloudDNS Requirements for the Node Deployment Process and Ongoing OperationsYou must ensure the following DNS names are resolvable and reachable from the node's management and tenant subnets using the specific ports and protocols as listed in the following table. Horizon Cloud uses specific outbound ports to securely download the node software into your Microsoft Azure environment and so that the node can connect back to the Horizon Cloud control plane. You must configure your network firewall such that Horizon Cloud has the ability to contact the DNS addresses on the ports that it requires. Otherwise, the node deployment process will fail. Horizon CloudHorizon CloudHorizon CloudCaution:Do not create the management and tenant subnets in advance on the VNet you create. The node deployment process creates those subnets using the CIDR information you enter into the on-screen wizard. If you create the subnets in advance, the node deployment wizard will flag an error and block further advancement in the wizard. Table 1. Node Deployment and Operations DNS RequirementsSource Node Subnet Source Node Subnet Destination (DNS name) Destination (DNS name) Port Port Protocol Protocol Purpose Purpose Management Management One of the following, depending on which Horizon Cloud control plane is specified in your Horizon Cloud account: cloud.horizon.vmware.com cloud-eu-central-1.horizon.vmware.com cloud-ap-southeast-2.horizon.vmware.com One of the following, depending on which Horizon Cloud control plane is specified in your Horizon Cloud account: Horizon CloudHorizon Cloudcloud.horizon.vmware.com cloud-eu-central-1.horizon.vmware.com cloud-ap-southeast-2.horizon.vmware.com TCP TCP Horizon Cloud control plane. cloud.horizon.vmware.com is in the United States cloud-eu-central-1.horizon.vmware.com is in Europe cloud-ap-southeast-2.horizon.vmware.com is in Australia Horizon Cloud control plane. Horizon Cloudcloud.horizon.vmware.com is in the United States cloud-eu-central-1.horizon.vmware.com is in Europe cloud-ap-southeast-2.horizon.vmware.com is in Australia Management Management softwareupdate.vmware.com softwareupdate.vmware.com TCP TCP VMware software package server. Used for downloading updates of the agent-related software used in the system's image-related operations. VMware software package server. Used for downloading updates of the agent-related software used in the system's image-related operations. Management Management d1mes20qfad06k.cloudfront.net d1mes20qfad06k.cloudfront.net TCP TCP Horizon Cloud content delivery server. On the management subnet, this site is used for downloading the VHDs (virtual hard disks) for the node-manager and Unified Access Gateway VMs. Horizon Cloud content delivery server. On the management subnet, this site is used for downloading the VHDs (virtual hard disks) for the node-manager and Unified Access Gateway VMs. Horizon CloudManagement Management s3-us-west-2.amazonaws.com s3-us-west-2.amazonaws.com TCP TCP Horizon Cloud content delivery server. On the management subnet, this site is used for downloading binaries used for the node-manager and Unified Access Gateway VMs. Horizon Cloud content delivery server. On the management subnet, this site is used for downloading binaries used for the node-manager and Unified Access Gateway VMs. Horizon CloudManagement Management packages.microsoft.com packages.microsoft.com TCP TCP Microsoft software package server. Used to securely download the Microsoft Azure Command Line Interface (CLI) software. Microsoft software package server. Used to securely download the Microsoft Azure Command Line Interface (CLI) software. Management Management azure.archive.ubuntu.com azure.archive.ubuntu.com TCP TCP Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Management Management api.snapcraft.io api.snapcraft.io TCP TCP Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Management Management archive.ubuntu.com archive.ubuntu.com TCP TCP Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Ubuntu software package server. Used by the node's Linux-based VMs for Ubuntu operating system updates. Management Management changelogs.ubuntu.com changelogs.ubuntu.com TCP TCP Ubuntu software package server. Used by the node's Linux-based VMs for tracking Ubuntu operating system updates. Ubuntu software package server. Used by the node's Linux-based VMs for tracking Ubuntu operating system updates. Management Management security.ubuntu.com security.ubuntu.com TCP TCP Ubuntu software package server. Used by the node's Linux-based VMs for security-related Ubuntu operating system updates. Ubuntu software package server. Used by the node's Linux-based VMs for security-related Ubuntu operating system updates. Tenant Tenant d1mes20qfad06k.cloudfront.net d1mes20qfad06k.cloudfront.net TCP TCP Horizon Cloud content delivery server. On the tenant subnet, this site is used by the system's automated Import Image process for downloading the installer for the agent-related software. Horizon Cloud content delivery server. On the tenant subnet, this site is used by the system's automated Import Image process for downloading the installer for the agent-related software. Horizon CloudTenant Tenant s3-us-west-2.amazonaws.com s3-us-west-2.amazonaws.com TCP TCP Horizon Cloud content delivery server. On the tenant subnet, this site is used for downloading binaries used for the images. Horizon Cloud content delivery server. On the tenant subnet, this site is used for downloading binaries used for the images. Horizon CloudTenant Tenant kinesis.us-east-1.amazonaws.com query-prod-us-east-1.cms.vmware.com kinesis.us-east-1.amazonaws.com query-prod-us-east-1.cms.vmware.com TCP TCP Cloud Monitoring Service (CMS) Cloud Monitoring Service (CMS) Ports and Protocols Required for Ongoing OperationsIn addition to the DNS requirements, the ports and protocols in the following tables are required for the node to operate properly for ongoing operations after deployment. Table 2. Node Operations Ports and ProtocolsSource Source Target Target Ports Ports Protocol Protocol Purpose Purpose Node manager VM Node manager VM Domain controller Domain controller TCP UDP TCP UDP LDAP services. Server that contains a domain controller role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. LDAP services. Server that contains a domain controller role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. Node manager VM Node manager VM Global catalog Global catalog TCP TCP LDAP services. Server that contains global catalog role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. LDAP services. Server that contains global catalog role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. Node manager VM Node manager VM Domain controller Domain controller TCP UDP TCP UDP Kerberos services. Server that contains a domain controller role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. Kerberos services. Server that contains a domain controller role in an Active Directory configuration. Registering the node with an Active Directory is a requirement. Node manager VM Node manager VM DNS server DNS server TCP UDP TCP UDP DNS services. DNS services. Node manager VM Node manager VM NTP server NTP server UDP UDP NTP services. Server that provides NTP time synchronization. NTP services. Server that provides NTP time synchronization. Unified Access Gateway instances in the node Unified Access Gateway instances in the node True SSO Enrollment Server True SSO Enrollment Server TCP TCP True SSO Enrollment Server. Optional if you are not using True SSO Enrollment Server capabilities with your nodes. True SSO Enrollment Server. Optional if you are not using True SSO Enrollment Server capabilities with your nodes. Node manager VM Node manager VM RADIUS RADIUS UDP UDP RADIUS authentication port. Optional if you are not using RADIUS two-factor authentication capabilities. RADIUS authentication port. Optional if you are not using RADIUS two-factor authentication capabilities. Node manager VM Node manager VM VMware Identity Managerâ„¢ service VMware Identity Managerâ„¢ service HTTPS HTTPS Optional if you are not using VMware Identity Managerâ„¢ with the node. Used to create a trust relationship between the node and the VMware Identity Managerâ„¢ service. Ensure that the node can reach the VMware Identity Managerâ„¢ environment you are using, either on-premises or the cloud service, on port 443. If you are using the VMware Identity Managerâ„¢ cloud service, see also the list of VMware Identity Managerâ„¢ service IP addresses to which the VMware Identity Managerâ„¢ Connector and the node must have access in the VMware Knowledge Base article 2149884. Optional if you are not using VMware Identity Managerâ„¢ with the node. Used to create a trust relationship between the node and the VMware Identity Managerâ„¢ service. Ensure that the node can reach the VMware Identity Managerâ„¢ environment you are using, either on-premises or the cloud service, on port 443. If you are using the VMware Identity Managerâ„¢ cloud service, see also the list of VMware Identity Managerâ„¢ service IP addresses to which the VMware Identity Managerâ„¢ Connector and the node must have access in the VMware Knowledge Base article 2149884. VMware Knowledge Base article 2149884Which ports must be opened for traffic from the end users' connections to reach their node-provisioned virtual desktops and remote applications depends on the choice you make for how your end users will connect: When you choose the option for having Internet-enabled desktops for the node, Unified Access Gateway instances are automatically deployed in your Microsoft Azure environment, along with a load balancer to those instances. The diagram Horizon Cloud Node Architecture Illustration depicts the location of the load balancer and the Unified Access Gateway instances. End users can connect to the node's load balancer, which distributes the requests to the Unified Access Gateway instances. You must ensure that those end-user connections can reach the node's load balancer using the ports and protocols listed below. In a deployed node, the load balancer is located in the resource group named vmw-hcs-nodeUUID-uag, where nodeUUID is the node's UUID. When you choose the option for having Internet-enabled desktops for the node, Unified Access Gateway instances are automatically deployed in your Microsoft Azure environment, along with a load balancer to those instances. The diagram Horizon Cloud Node Architecture Illustration depicts the location of the load balancer and the Unified Access Gateway instances. End users can connect to the node's load balancer, which distributes the requests to the Unified Access Gateway instances. You must ensure that those end-user connections can reach the node's load balancer using the ports and protocols listed below. In a deployed node, the load balancer is located in the resource group named vmw-hcs-nodeUUID-uag, where nodeUUID is the node's UUID. The diagram Horizon Cloud Node Architecture Illustration depicts the location of the load balancer and the Unified Access Gateway instances.Horizon Cloud Node Architecture Illustrationvmw-hcs-nodeUUID-uagnodeUUIDnodeUUIDWhen you do not choose the Internet-enabled desktops option, you instead have your end users connecting directly to the node, such as using a VPN. For this configuration, you upload an SSL certificate to the node instance from the node's summary page in the Administration Console, as described in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections. When you do not choose the Internet-enabled desktops option, you instead have your end users connecting directly to the node, such as using a VPN. For this configuration, you upload an SSL certificate to the node instance from the node's summary page in the Administration Console, as described in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections. For this configuration, you upload an SSL certificate to the node instance from the node's summary page in the Administration Console, as described in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections.Upload SSL Certificates to a Horizon Cloud Node for Direct ConnectionsFor detailed information about the Horizon Clients that your end users might use with your Horizon Cloud node, see the Horizon Client documentation page at https://docs.vmware.com/en/VMware-Horizon-Client/index.html. Horizon Cloudhttps://docs.vmware.com/en/VMware-Horizon-Client/index.htmlTable 3. External End User Connections Ports and Protocols when the Node Configuration has Unified Access Gateway instancesSource Source Target Target Port Port Protocol Protocol Purpose Purpose Horizon Client Horizon Client Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances TCP TCP Login authentication traffic. Can also carry client-drive redirection (CDR), multimedia redirection (MMR), USB redirection, and tunneled RDP traffic. SSL (HTTPS access) is enabled by default for client connections. Port 80 (HTTP access) can be used in some cases. See Understanding What URL Content Redirection Is. Login authentication traffic. Can also carry client-drive redirection (CDR), multimedia redirection (MMR), USB redirection, and tunneled RDP traffic. SSL (HTTPS access) is enabled by default for client connections. Port 80 (HTTP access) can be used in some cases. See Understanding What URL Content Redirection Is. See Understanding What URL Content Redirection Is.Understanding What URL Content Redirection IsHorizon Client Horizon Client Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances TCP UDP TCP UDP PCoIP via PCoIP Secure Gateway on Unified Access Gateway PCoIP via PCoIP Secure Gateway on Unified Access Gateway Horizon Client Horizon Client Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances TCP TCP Blast Extreme via Blast Secure Gateway on Unified Access Gateway for data traffic. Blast Extreme via Blast Secure Gateway on Unified Access Gateway for data traffic. Horizon Client Horizon Client Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances UDP UDP Blast Extreme via the Unified Access Gateway for data traffic. Blast Extreme via the Unified Access Gateway for data traffic. Horizon Client Horizon Client Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances UDP UDP Blast Extreme via Blast Secure Gateway on Unified Access Gateway for data traffic (adaptive transport). Blast Extreme via Blast Secure Gateway on Unified Access Gateway for data traffic (adaptive transport). Browser Browser Node load balancer to the Unified Access Gateway instances Node load balancer to the Unified Access Gateway instances TCP TCP HTML Access HTML Access Table 4. Internal End User Connections Ports and Protocols when using Direct Node Connections, Such as Over VPNSource Source Target Target Port Port Protocol Protocol Purpose Purpose Horizon Client Horizon Client Node manager VM Node manager VM TCP TCP Login authentication traffic Login authentication traffic Horizon Client Horizon Client Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP UDP TCP UDP PCoIP PCoIP Horizon Client Horizon Client Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP UDP TCP UDP Blast Extreme Blast Extreme Horizon Client Horizon Client Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP TCP USB redirection USB redirection Horizon Client Horizon Client Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP TCP Client-drive redirection (CDR) and multimedia redirection (MMR) Client-drive redirection (CDR) and multimedia redirection (MMR) Browser Browser Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP TCP HTML Access HTML Access For external connections using a node configured with Unified Access Gateway instances, traffic must be allowed from the node's Unified Access Gateway instances to targets as listed in the table below. During node deployment, a Network Security Group (NSG) is created in your Microsoft Azure environment for use by the node's Unified Access Gateway software. Table 5. Port Requirements for Traffic from the Node's Unified Access Gateway InstancesSource Source Target Target Port Port Protocol Protocol Purpose Purpose Unified Access Gateway instances in the node Unified Access Gateway instances in the node Node manager VM Node manager VM TCP TCP Login authentication traffic Login authentication traffic Unified Access Gateway instances in the node Unified Access Gateway instances in the node Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP UDP TCP UDP PCoIP PCoIP Unified Access Gateway instances in the node Unified Access Gateway instances in the node Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP UDP TCP UDP Blast Extreme By default, when using Blast Extreme, client-drive redirection (CDR) traffic and USB traffic is side-channeled in this port. If you prefer instead, the CDR traffic can be separated onto the TCP 9427 port and the USB redirection traffic can be separated onto the TCP 32111 port. Blast Extreme By default, when using Blast Extreme, client-drive redirection (CDR) traffic and USB traffic is side-channeled in this port. If you prefer instead, the CDR traffic can be separated onto the TCP 9427 port and the USB redirection traffic can be separated onto the TCP 32111 port. Unified Access Gateway instances in the node Unified Access Gateway instances in the node Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP TCP Optional for client driver redirection (CDR) and multimedia redirection (MMR) traffic. Optional for client driver redirection (CDR) and multimedia redirection (MMR) traffic. Unified Access Gateway instances in the node Unified Access Gateway instances in the node Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs TCP TCP Optional for USB redirection traffic. Optional for USB redirection traffic. Unified Access Gateway instances in the node Unified Access Gateway instances in the node Your RADIUS instance Your RADIUS instance UDP UDP When using RADIUS two-factor authentication with the node. The default value for RADIUS is shown here. When using RADIUS two-factor authentication with the node. The default value for RADIUS is shown here. The following ports must allow traffic from the Horizon agent-related software that is installed in the desktop VMs and farm server VMs. Source Source Target Target Port Port Protocol Protocol Purpose Purpose Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs Node manager VM Node manager VM TCP TCP Java Message Service (JMS) when using enhanced security (the default) Java Message Service (JMS) when using enhanced security (the default) Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs Node manager VM Node manager VM TCP TCP Java Message Service (JMS), legacy Java Message Service (JMS), legacy Horizon agent in the desktop or farm server VMs Horizon agent in the desktop or farm server VMs Node manager VM Node manager VM TCP TCP Desktop message server Desktop message server User Environment Manager agent (FlexEngine) in the desktop or farm server VMs User Environment Manager agent (FlexEngine) in the desktop or farm server VMs Those file shares you set up for use by the User Environment Manager agent the desktop or farm server VMs Those file shares you set up for use by the User Environment Manager agent the desktop or farm server VMs TCP TCP User Environment Manager agent access to your SMB file shares, if you are using User Environment Manager capabilities. User Environment Manager agent access to your SMB file shares, if you are using User Environment Manager capabilities. Parent topic:Managing Your Horizon Cloud NodesVMware, Inc x 