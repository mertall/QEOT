VMware DocsMyLibrarytimesMyLibraryMyLibraryclose-lineAfter the first node deployment, you can deploy additional nodes from the Capacity page. About this taskWhen you add a new node, you can use the same subscription that you used before for your previous nodes, or you can use a different subscription if required by your organization. If you plan to use different subscription, you must perform the steps described in Getting Started with VMware Horizon Cloud Service on Microsoft Azure to obtain the subscription ID, directory ID, application ID, and application key. You can navigate to the getting started document online from here. Getting Started with VMware Horizon Cloud Service on Microsoft AzurehereCaution:The IP addresses mentioned in these steps are examples. You should use the address ranges that meet your organization's needs. For each step that mentions an IP address range, substitute ones that are applicable for your organization. PrerequisitesThe first node must be completely deployed and the Active Directory domain-bind and domain-join steps completed before you can deploy additional nodes. All nodes within your customer account record share the same Active Directory information. Verify that VNet is configured to point to a DNS that can resolve external addresses. The node deployer must be able to reach external addresses in the Horizon Cloud control plane to securely download the node software into your Microsoft Azure environment. Verify that VNet is configured to point to a DNS that can resolve external addresses. The node deployer must be able to reach external addresses in the Horizon Cloud control plane to securely download the node software into your Microsoft Azure environment. Horizon CloudVerify that you know the address ranges you are going to enter into the wizard for the management subnet, desktop subnet, and DMZ subnet (when choosing Internet-enabled desktops) and verify that those ranges do not overlap. You enter the address ranges using CIDR notation (classless inter-domain routing notation). The wizard will display an error if the entered subnet ranges overlap. For the management and DMZ subnet ranges, a CIDR of at least /28 is required. If you want to keep the management and DMZ subnet ranges co-located, you can specify the DMZ subnet range the same as the management subnet with an IP specified. For example, if the management subnet is 192.168.8.0/28, the DMZ subnet would be 192.168.8.32/28. Important: The CIDRs you enter in the wizard's fields must be defined so that each combination of prefix and bit mask results in an IP address range having the prefix as the starting IP address. Microsoft Azure requires that the CIDR prefix be the start of the range. For example, a correct CIDR of 192.168.182.48/28 would result in an IP range of 192.168.182.48 to 192.168.182.63, and the prefix is the same as the starting IP address (192.168.182.48). However, an incorrect CIDR of 192.168.182.60/28 would result in an IP range of 192.168.182.48 to 192.168.182.63, where the starting IP address is not the same as the prefix of 192.168.182.60. Ensure that your CIDRs result in IP address ranges where the starting IP address matches the CIDR prefix. Verify that you know the address ranges you are going to enter into the wizard for the management subnet, desktop subnet, and DMZ subnet (when choosing Internet-enabled desktops) and verify that those ranges do not overlap. You enter the address ranges using CIDR notation (classless inter-domain routing notation). The wizard will display an error if the entered subnet ranges overlap. For the management and DMZ subnet ranges, a CIDR of at least /28 is required. If you want to keep the management and DMZ subnet ranges co-located, you can specify the DMZ subnet range the same as the management subnet with an IP specified. For example, if the management subnet is 192.168.8.0/28, the DMZ subnet would be 192.168.8.32/28. Important:The CIDRs you enter in the wizard's fields must be defined so that each combination of prefix and bit mask results in an IP address range having the prefix as the starting IP address. Microsoft Azure requires that the CIDR prefix be the start of the range. For example, a correct CIDR of 192.168.182.48/28 would result in an IP range of 192.168.182.48 to 192.168.182.63, and the prefix is the same as the starting IP address (192.168.182.48). However, an incorrect CIDR of 192.168.182.60/28 would result in an IP range of 192.168.182.48 to 192.168.182.63, where the starting IP address is not the same as the prefix of 192.168.182.60. Ensure that your CIDRs result in IP address ranges where the starting IP address matches the CIDR prefix. Verify that subnets with those address ranges do not already exist on the VNet. The deployer itself will automatically create the subnets using the address ranges you provide in the wizard. If the wizard detects subnets with those ranges already exist, the wizard will display an error about overlapping addresses and will not proceed further. Verify that subnets with those address ranges do not already exist on the VNet. The deployer itself will automatically create the subnets using the address ranges you provide in the wizard. If the wizard detects subnets with those ranges already exist, the wizard will display an error about overlapping addresses and will not proceed further. If you require use of a proxy for outbound Internet access, verify you have the networking information for your proxy configuration and the authentication credentials it requires, if any. The node deployment process requires outbound Internet access. If you require use of a proxy for outbound Internet access, verify you have the networking information for your proxy configuration and the authentication credentials it requires, if any. The node deployment process requires outbound Internet access. Verify that you have the information for at least one NTP server that you want the node to use for time synchronization. The NTP server can be a public NTP server or your own NTP server that you set up for this purpose. The NTP server you specify must be reachable from the virtual network you configured. When you plan to use an NTP server using its domain name instead of a numeric IP address, also ensure that the DNS configured for the virtual network can resolve the NTP server's name. Verify that you have the information for at least one NTP server that you want the node to use for time synchronization. The NTP server can be a public NTP server or your own NTP server that you set up for this purpose. The NTP server you specify must be reachable from the virtual network you configured. When you plan to use an NTP server using its domain name instead of a numeric IP address, also ensure that the DNS configured for the virtual network can resolve the NTP server's name. If you are planning to use the Unified Access Gateway capability to have Internet-enabled desktops from this node, you must provide: A fully qualified domain name (FQDN) that is unique to this node. You cannot reuse an FQDN that is already configured for your other deployed nodes. Important: This FQDN cannot contain underscores. In this release, connections to the Unified Access Gateway instances will fail when the FQDN contains underscores. A fully qualified domain name (FQDN) that is unique to this node. You cannot reuse an FQDN that is already configured for your other deployed nodes. Important:This FQDN cannot contain underscores. In this release, connections to the Unified Access Gateway instances will fail when the FQDN contains underscores. Unified Access GatewayA signed SSL server certificate (in PEM format) based on that FQDN. The Unified Access Gateway capabilities require SSL for client connections, as described in the Unified Access Gateway product documentation. The certificate must be signed by a trusted Certificate Authority (CA). The single PEM file must contain the full entire certificate chain with the private key. For example, the single PEM file must contain the SSL server certificate, any necessary intermediate CA certificates, the root CA certificate, and private key. OpenSSL is a tool you can use to create the PEM file. A signed SSL server certificate (in PEM format) based on that FQDN. The Unified Access Gateway capabilities require SSL for client connections, as described in the Unified Access Gateway product documentation. The certificate must be signed by a trusted Certificate Authority (CA). The single PEM file must contain the full entire certificate chain with the private key. For example, the single PEM file must contain the SSL server certificate, any necessary intermediate CA certificates, the root CA certificate, and private key. OpenSSL is a tool you can use to create the PEM file. Unified Access GatewayUnified Access GatewayFor more information about the PEM file considerations required by Unified Access Gateway, see Convert a Certificate File to the PEM Format Required for Node Deployment. Unified Access GatewayConvert a Certificate File to the PEM Format Required for Node DeploymentIf you are planning to use the two-factor authentication capability, or use it with an on-premises two-factor authentication server, verify that you have the following information used in your authentication server's configuration, so that you can provide it in the appropriate fields in the node deployment wizard. If you have both a primary and secondary server, obtain the information for each of them. IP address or DNS name of the authentication server IP address or DNS name of the authentication server The shared secret that is used for encryption and decryption in the authentication server's protocol messages The shared secret that is used for encryption and decryption in the authentication server's protocol messages Authentication port numbers, typically the 1812 UDP port. Authentication port numbers, typically the 1812 UDP port. Authentication protocol type. The authentication types include PAP (Password Authentication Protocol), CHAP (Challenge Handshake Authentication Protocol), MSCHAP1, MSCHAP2 (Microsoft Challenge Handshake Authentication Protocol, version 1 and 2) Authentication protocol type. The authentication types include PAP (Password Authentication Protocol), CHAP (Challenge Handshake Authentication Protocol), MSCHAP1, MSCHAP2 (Microsoft Challenge Handshake Authentication Protocol, version 1 and 2) ProcedureIn the Administration Console, navigate to Settings > Capacity. In the Administration Console, navigate to Settings > Capacity. Settings > CapacitySettingsCapacityClick New > Node Click New > Node New > NodeNewNodeClick Select under the Microsoft Azure option. The Add Cloud Capacity wizard opens to its first step. Click Select under the Microsoft Azure option. SelectOn the wizard's first step, specify the subscription to use for this node by selecting the name of a previously entered subscription or entering new subscription information. If you select an existing subscription, the step is populated with that subscription's information that was previously entered into the system. Option Description Apply Subscription Select the name of a previously entered subscription or select Add New to enter new subscription information. Subscription Name When providing new subscription information, enter a friendly name so you can identify this subscription from other previously entered subscriptions. The name must start with a letter and contain only letters, dashes, and numbers. Environment Select the cloud environment associated with your subscription, for example: Azure, for the standard global Microsoft Azure cloud Azure - China, for the Microsoft Azure in China cloud Azure - Germany, for the Microsoft Azure Germany cloud Azure - US Government, for the Microsoft Azure US Government cloud Subscription ID Enter your cloud capacity subscription ID (in UUID form). This subscription ID must be valid for the environment you selected. For Microsoft Azure, you can obtain this UUID from your Microsoft Azure portal's Subscriptions area. Directory ID Enter your Microsoft Azure AD Directory ID (in UUID form). For Microsoft Azure, you can obtain this UUID from your Microsoft Azure Active Directory properties in the Microsoft Azure portal. Application ID Enter the application ID (in UUID form) associated with the service principal you created in the Microsoft Azure portal. Creating an application registration and its associated service principal in your Microsoft Azure Active Directory is a prerequisite. Application Key Enter the key value for the service principal's authentication key that you created in the Microsoft Azure portal. Creating this key is a prerequisite. On the wizard's first step, specify the subscription to use for this node by selecting the name of a previously entered subscription or entering new subscription information. If you select an existing subscription, the step is populated with that subscription's information that was previously entered into the system. OptionOptionDescriptionDescriptionApply SubscriptionApply SubscriptionApply SubscriptionSelect the name of a previously entered subscription or select Add New to enter new subscription information.Select the name of a previously entered subscription or select Add New to enter new subscription information.Add NewSubscription NameSubscription NameSubscription NameWhen providing new subscription information, enter a friendly name so you can identify this subscription from other previously entered subscriptions. The name must start with a letter and contain only letters, dashes, and numbers. When providing new subscription information, enter a friendly name so you can identify this subscription from other previously entered subscriptions. The name must start with a letter and contain only letters, dashes, and numbers. EnvironmentEnvironmentEnvironmentSelect the cloud environment associated with your subscription, for example: Azure, for the standard global Microsoft Azure cloud Azure - China, for the Microsoft Azure in China cloud Azure - Germany, for the Microsoft Azure Germany cloud Azure - US Government, for the Microsoft Azure US Government cloud Select the cloud environment associated with your subscription, for example: Azure, for the standard global Microsoft Azure cloud Azure, for the standard global Microsoft Azure cloud AzureAzure - China, for the Microsoft Azure in China cloud Azure - China, for the Microsoft Azure in China cloud Azure - ChinaAzure - Germany, for the Microsoft Azure Germany cloud Azure - Germany, for the Microsoft Azure Germany cloud Azure - GermanyAzure - US Government, for the Microsoft Azure US Government cloud Azure - US Government, for the Microsoft Azure US Government cloud Azure - US GovernmentSubscription IDSubscription IDSubscription IDEnter your cloud capacity subscription ID (in UUID form). This subscription ID must be valid for the environment you selected. For Microsoft Azure, you can obtain this UUID from your Microsoft Azure portal's Subscriptions area.Enter your cloud capacity subscription ID (in UUID form). This subscription ID must be valid for the environment you selected. For Microsoft Azure, you can obtain this UUID from your Microsoft Azure portal's Subscriptions area.Directory IDDirectory IDDirectory IDEnter your Microsoft Azure AD Directory ID (in UUID form). For Microsoft Azure, you can obtain this UUID from your Microsoft Azure Active Directory properties in the Microsoft Azure portal.Enter your Microsoft Azure AD Directory ID (in UUID form). For Microsoft Azure, you can obtain this UUID from your Microsoft Azure Active Directory properties in the Microsoft Azure portal.Application IDApplication IDApplication IDEnter the application ID (in UUID form) associated with the service principal you created in the Microsoft Azure portal. Creating an application registration and its associated service principal in your Microsoft Azure Active Directory is a prerequisite.Enter the application ID (in UUID form) associated with the service principal you created in the Microsoft Azure portal. Creating an application registration and its associated service principal in your Microsoft Azure Active Directory is a prerequisite.Application KeyApplication KeyApplication KeyEnter the key value for the service principal's authentication key that you created in the Microsoft Azure portal. Creating this key is a prerequisite.Enter the key value for the service principal's authentication key that you created in the Microsoft Azure portal. Creating this key is a prerequisite.Proceed to the next step by clicking Next. When you click Next, in the case where you added a new subscription, the system verifies the validity of all of the specified values and whether they are appropriately related to each other, such as: Is the specified subscription ID valid in the selected environment. Are the specified directory ID, application ID, and application key valid in that subscription. Is the Contributor role configured on the application's service principal for the specified application ID. If you see an error message about checking values, at least one of the values is invalid either by not existing in your subscription or not having a valid relationship with another of the values. For example, if you specified a Directory ID that is in your subscription but you specified an Application ID value that is in a different directory, the error message will display. More than one value might be invalid if that error message appears. If you see that error message, verify the subscription-related information that you collected and the configuration of the service principal. Proceed to the next step by clicking Next. NextWhen you click Next, in the case where you added a new subscription, the system verifies the validity of all of the specified values and whether they are appropriately related to each other, such as: NextIs the specified subscription ID valid in the selected environment. Is the specified subscription ID valid in the selected environment. Are the specified directory ID, application ID, and application key valid in that subscription. Are the specified directory ID, application ID, and application key valid in that subscription. Is the Contributor role configured on the application's service principal for the specified application ID. Is the Contributor role configured on the application's service principal for the specified application ID. ContributorIf you see an error message about checking values, at least one of the values is invalid either by not existing in your subscription or not having a valid relationship with another of the values. For example, if you specified a Directory ID that is in your subscription but you specified an Application ID value that is in a different directory, the error message will display. Directory IDApplication IDMore than one value might be invalid if that error message appears. If you see that error message, verify the subscription-related information that you collected and the configuration of the service principal. In this wizard step, specify details such as the name of the node, as well as networking information. The following screenshot illustrates this step after the fields are completed. Option Description Node Name Enter a friendly name for this node. This name is used in the Administration Console to identify this node from your other nodes. Location Select an existing location or click Add to specify a new one. Locations group your nodes according to names you provide (Business Unit A, Business Unit B, East Coast Stores, and so on). Microsoft Azure Region Select the physical geographic Microsoft Azure region into which you want the node to be deployed. The available regions are determined by the previously selected Microsoft Azure environment. Consider choosing the region based on its proximity to the end users you intend to serve with this node. Nearer proximity would provide lower latency. Important: Not all Microsoft Azure regions support GPU-enabled virtual machines. If you want to use the node for GPU-capable desktops or remote applications, ensure that the Microsoft Azure region you select for the node provides for those NV-series VM types that you want to use and which are supported in this Horizon Cloud release. See the Microsoft documentation at https://azure.microsoft.com/en-us/regions/services/ for details. Description Optional: Enter a description for this node. Virtual Network Select a virtual network from the list. Only virtual networks (VNets) that exist in the region selected in the Microsoft Azure Region field are shown here. You must have already created the VNet you want to use in that region in your Microsoft Azure subscription. Management Subnet (CIDR) Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which the node and Unified Access Gateway instances will get connected, such as 192.168.8.0/28. For the management subnet, a CIDR of at least /28 is required. Caution: The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. Desktop Subnet (CIDR) Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which all of this node's VDI desktops and RDSH farm servers for end-user remote desktops and applications will get connected, such as 192.168.12.0/22. Minimum: /28. Recommended: /22. Caution: The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. NTP Servers Enter the list of NTP servers you want to use for time synchronization, separated by commas. An NTP server you enter here can be a public NTP server or your own NTP server that you set up for providing time synchronization. The NTP servers you specify here must be reachable from the virtual network you selected in the Virtual Network field for the node to use. In this field, you can specify each NTP server either by its numeric IP address or its domain name. When you provide a domain name in this field instead of a numeric IP address, you must ensure that the DNS configured for your virtual network can resolve the specified name. Examples of public NTP server domain names are time.windows.com, us.pool.ntp.org, time.google.com. Use Proxy If you require a proxy for outbound Internet connectivity, set this toggle to Yes and complete the associated displayed fields. The node deployer requires outbound access to the Internet to securely download software into the Microsoft Azure cloud environment and connect back to the Horizon Cloud cloud control plane. To enable the node to use your proxy configuration, you must provide the following information after setting the toggle to Yes. Proxy (required): Type the hostname or IP address for your proxy server. Port (required): Type the port number that is specified in your proxy server configuration. If your proxy server configuration requires a user name and password for authentication, provide those credentials also. In this wizard step, specify details such as the name of the node, as well as networking information. OptionOptionDescriptionDescriptionNode NameNode NameNode NameEnter a friendly name for this node. This name is used in the Administration Console to identify this node from your other nodes.Enter a friendly name for this node. This name is used in the Administration Console to identify this node from your other nodes.LocationLocationLocationSelect an existing location or click Add to specify a new one. Locations group your nodes according to names you provide (Business Unit A, Business Unit B, East Coast Stores, and so on). Select an existing location or click Add to specify a new one. AddLocations group your nodes according to names you provide (Business Unit A, Business Unit B, East Coast Stores, and so on). Microsoft Azure RegionMicrosoft Azure RegionMicrosoft Azure RegionSelect the physical geographic Microsoft Azure region into which you want the node to be deployed. The available regions are determined by the previously selected Microsoft Azure environment. Consider choosing the region based on its proximity to the end users you intend to serve with this node. Nearer proximity would provide lower latency. Important: Not all Microsoft Azure regions support GPU-enabled virtual machines. If you want to use the node for GPU-capable desktops or remote applications, ensure that the Microsoft Azure region you select for the node provides for those NV-series VM types that you want to use and which are supported in this Horizon Cloud release. See the Microsoft documentation at https://azure.microsoft.com/en-us/regions/services/ for details. Select the physical geographic Microsoft Azure region into which you want the node to be deployed. The available regions are determined by the previously selected Microsoft Azure environment. Consider choosing the region based on its proximity to the end users you intend to serve with this node. Nearer proximity would provide lower latency. Important:Not all Microsoft Azure regions support GPU-enabled virtual machines. If you want to use the node for GPU-capable desktops or remote applications, ensure that the Microsoft Azure region you select for the node provides for those NV-series VM types that you want to use and which are supported in this Horizon Cloud release. See the Microsoft documentation at https://azure.microsoft.com/en-us/regions/services/ for details. Horizon Cloudhttps://azure.microsoft.com/en-us/regions/services/DescriptionDescriptionDescriptionOptional: Enter a description for this node.Optional: Enter a description for this node.Virtual NetworkVirtual NetworkVirtual NetworkSelect a virtual network from the list. Only virtual networks (VNets) that exist in the region selected in the Microsoft Azure Region field are shown here. You must have already created the VNet you want to use in that region in your Microsoft Azure subscription. Select a virtual network from the list. Only virtual networks (VNets) that exist in the region selected in the Microsoft Azure Region field are shown here. You must have already created the VNet you want to use in that region in your Microsoft Azure subscription. Microsoft Azure RegionManagement Subnet (CIDR)Management Subnet (CIDR)Management Subnet (CIDR)Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which the node and Unified Access Gateway instances will get connected, such as 192.168.8.0/28. For the management subnet, a CIDR of at least /28 is required. Caution: The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which the node and Unified Access Gateway instances will get connected, such as 192.168.8.0/28. For the management subnet, a CIDR of at least /28 is required. Caution:The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. Desktop Subnet (CIDR)Desktop Subnet (CIDR)Desktop Subnet (CIDR)Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which all of this node's VDI desktops and RDSH farm servers for end-user remote desktops and applications will get connected, such as 192.168.12.0/22. Minimum: /28. Recommended: /22. Caution: The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. Enter a subnet address range (in CIDR notation) for the deployer to create a subnet to which all of this node's VDI desktops and RDSH farm servers for end-user remote desktops and applications will get connected, such as 192.168.12.0/22. Minimum: /28. Recommended: /22. Caution:The subnet must not already exist in your Microsoft Azure environment. If it already exists, you will get an error when you try to proceed to the next wizard step. NTP ServersNTP ServersNTP ServersEnter the list of NTP servers you want to use for time synchronization, separated by commas. An NTP server you enter here can be a public NTP server or your own NTP server that you set up for providing time synchronization. The NTP servers you specify here must be reachable from the virtual network you selected in the Virtual Network field for the node to use. In this field, you can specify each NTP server either by its numeric IP address or its domain name. When you provide a domain name in this field instead of a numeric IP address, you must ensure that the DNS configured for your virtual network can resolve the specified name. Examples of public NTP server domain names are time.windows.com, us.pool.ntp.org, time.google.com. Enter the list of NTP servers you want to use for time synchronization, separated by commas. An NTP server you enter here can be a public NTP server or your own NTP server that you set up for providing time synchronization. The NTP servers you specify here must be reachable from the virtual network you selected in the Virtual Network field for the node to use. In this field, you can specify each NTP server either by its numeric IP address or its domain name. When you provide a domain name in this field instead of a numeric IP address, you must ensure that the DNS configured for your virtual network can resolve the specified name. Virtual NetworkExamples of public NTP server domain names are time.windows.com, us.pool.ntp.org, time.google.com. time.windows.comus.pool.ntp.orgtime.google.comUse ProxyUse ProxyUse ProxyIf you require a proxy for outbound Internet connectivity, set this toggle to Yes and complete the associated displayed fields. The node deployer requires outbound access to the Internet to securely download software into the Microsoft Azure cloud environment and connect back to the Horizon Cloud cloud control plane. To enable the node to use your proxy configuration, you must provide the following information after setting the toggle to Yes. Proxy (required): Type the hostname or IP address for your proxy server. Port (required): Type the port number that is specified in your proxy server configuration. If your proxy server configuration requires a user name and password for authentication, provide those credentials also. If you require a proxy for outbound Internet connectivity, set this toggle to Yes and complete the associated displayed fields. YesThe node deployer requires outbound access to the Internet to securely download software into the Microsoft Azure cloud environment and connect back to the Horizon Cloud cloud control plane. To enable the node to use your proxy configuration, you must provide the following information after setting the toggle to Yes. Horizon CloudYesProxy (required): Type the hostname or IP address for your proxy server. Proxy (required): Type the hostname or IP address for your proxy server. ProxyPort (required): Type the port number that is specified in your proxy server configuration. Port (required): Type the port number that is specified in your proxy server configuration. PortIf your proxy server configuration requires a user name and password for authentication, provide those credentials also. Proceed to the next step by clicking Next. Proceed to the next step by clicking Next. NextIn this wizard step, specify details for the node to support Internet-enabled desktops. You can configure the node with the ability to provide access to desktops and applications for end users located outside of your corporate network. By default, Yes is selected in this wizard step to have Internet-enabled desktops. With this configuration, the node includes a load balancer and Unified Access Gateway instances to enable this access. The following screenshot is an example of the step when it is initially displayed. Option Description Internet Enabled Desktops? When Yes is selected, access to desktops and applications is enabled for users located outside of your corporate network. The node includes a load balancer and Unified Access Gateway instances to enable this access. Note: Leaving the default Yes setting is recommended. When set to No, clients must connect directly to the node and not through Unified Access Gateway. In this case, after the node is deployed, follow the steps in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections. FQDN Enter the required fully qualified domain name (FQDN), such as ourOrg.example.com, which your end users will use to access the service. You must own that domain name and have a certificate in PEM format that can validate that FQDN. Important: This FQDN cannot contain underscores. In this release, connections to the Unified Access Gateway instances will fail when the FQDN contains underscores. DMZ Subnet (CIDR) Enter the subnet (in CIDR notation) for the DMZ (demilitarized zone) network that will be configured to connect the Unified Access Gateway instances to the load balancer. DNS Addresses Optionally enter addresses for additional DNS servers that Unified Access Gateway can use for name resolution, separated by commas (for example 198.51.100.1, 8.8.8.8, 75.75.75.75, ourdns.example.com). When configuring this node to use two-factor authentication with your on-premises RADIUS server, you would specify the address of a DNS server that can resolve the name of your on-premises RADIUS server. As described in Getting Started with VMware Horizon Cloud Service on Microsoft Azure, a DNS server must be set up internally in your subscription and configured to provide external name resolution. The Unified Access Gateway instances use that DNS server by default. If you specify addresses in this field, the deployed Unified Access Gateway instances use the addresses in addition to the prerequisite DNS server that you configured in your subscription's virtual network. Routes Optionally specify custom routes to additional gateways that you want the deployed Unified Access Gateway instances to use to resolve network routing for the end user access. The specified routes are used to allow Unified Access Gateway to resolve network routing such as to RADIUS servers for two-factor authentication. When configuring this node to use two-factor authentication with an on-premises RADIUS server, you must enter the correct route the Unified Access Gateway instances can use to reach the RADIUS server. For example, if your on-premises RADIUS server uses 10.10.60.20 as its IP address, you would enter 10.10.60.0/24 and your default route gateway address as a custom route. You obtain your default route gateway address from the Express Route or VPN configuration you are using for this environment. Specify the custom routes as a comma-separated list in the form ipv4-network-address/bits ipv4-gateway-address, for example: 192.168.1.0/24 192.168.0.1, 192.168.2.0/24 192.168.0.2. Certificate Upload the certificate in PEM format that Unified Access Gateway will use to allow clients to trust connections to the Unified Access Gateway instances running in Microsoft Azure. The certificate must be based on the FQDN you entered and be signed by a trusted CA. The following screenshot is an example with the fields completed. If you do not want to configure the end users' desktops to use RADIUS two-factor authentication, you can click Validate & Proceed to continue to the summary step. In this wizard step, specify details for the node to support Internet-enabled desktops. You can configure the node with the ability to provide access to desktops and applications for end users located outside of your corporate network. By default, Yes is selected in this wizard step to have Internet-enabled desktops. With this configuration, the node includes a load balancer and Unified Access Gateway instances to enable this access. YesUnified Access GatewayThe following screenshot is an example of the step when it is initially displayed. OptionOptionDescriptionDescriptionInternet Enabled Desktops?Internet Enabled Desktops?Internet Enabled Desktops?When Yes is selected, access to desktops and applications is enabled for users located outside of your corporate network. The node includes a load balancer and Unified Access Gateway instances to enable this access. Note: Leaving the default Yes setting is recommended. When set to No, clients must connect directly to the node and not through Unified Access Gateway. In this case, after the node is deployed, follow the steps in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections. When Yes is selected, access to desktops and applications is enabled for users located outside of your corporate network. The node includes a load balancer and Unified Access Gateway instances to enable this access. YesUnified Access GatewayNote:Leaving the default Yes setting is recommended. YesWhen set to No, clients must connect directly to the node and not through Unified Access Gateway. In this case, after the node is deployed, follow the steps in Upload SSL Certificates to a Horizon Cloud Node for Direct Connections. NoUnified Access GatewayUpload SSL Certificates to a Horizon Cloud Node for Direct ConnectionsFQDNFQDNFQDNEnter the required fully qualified domain name (FQDN), such as ourOrg.example.com, which your end users will use to access the service. You must own that domain name and have a certificate in PEM format that can validate that FQDN. Important: This FQDN cannot contain underscores. In this release, connections to the Unified Access Gateway instances will fail when the FQDN contains underscores. Enter the required fully qualified domain name (FQDN), such as ourOrg.example.com, which your end users will use to access the service. You must own that domain name and have a certificate in PEM format that can validate that FQDN. ourOrg.example.comImportant:This FQDN cannot contain underscores. In this release, connections to the Unified Access Gateway instances will fail when the FQDN contains underscores. Unified Access GatewayDMZ Subnet (CIDR)DMZ Subnet (CIDR)DMZ Subnet (CIDR)Enter the subnet (in CIDR notation) for the DMZ (demilitarized zone) network that will be configured to connect the Unified Access Gateway instances to the load balancer. Enter the subnet (in CIDR notation) for the DMZ (demilitarized zone) network that will be configured to connect the Unified Access Gateway instances to the load balancer. Unified Access GatewayDNS AddressesDNS AddressesDNS AddressesOptionally enter addresses for additional DNS servers that Unified Access Gateway can use for name resolution, separated by commas (for example 198.51.100.1, 8.8.8.8, 75.75.75.75, ourdns.example.com). When configuring this node to use two-factor authentication with your on-premises RADIUS server, you would specify the address of a DNS server that can resolve the name of your on-premises RADIUS server. As described in Getting Started with VMware Horizon Cloud Service on Microsoft Azure, a DNS server must be set up internally in your subscription and configured to provide external name resolution. The Unified Access Gateway instances use that DNS server by default. If you specify addresses in this field, the deployed Unified Access Gateway instances use the addresses in addition to the prerequisite DNS server that you configured in your subscription's virtual network. Optionally enter addresses for additional DNS servers that Unified Access Gateway can use for name resolution, separated by commas (for example 198.51.100.1, 8.8.8.8, 75.75.75.75, ourdns.example.com). When configuring this node to use two-factor authentication with your on-premises RADIUS server, you would specify the address of a DNS server that can resolve the name of your on-premises RADIUS server. Unified Access GatewayAs described in Getting Started with VMware Horizon Cloud Service on Microsoft Azure, a DNS server must be set up internally in your subscription and configured to provide external name resolution. The Unified Access Gateway instances use that DNS server by default. If you specify addresses in this field, the deployed Unified Access Gateway instances use the addresses in addition to the prerequisite DNS server that you configured in your subscription's virtual network. Getting Started with VMware Horizon Cloud Service on Microsoft AzureUnified Access GatewayUnified Access GatewayRoutesRoutesRoutesOptionally specify custom routes to additional gateways that you want the deployed Unified Access Gateway instances to use to resolve network routing for the end user access. The specified routes are used to allow Unified Access Gateway to resolve network routing such as to RADIUS servers for two-factor authentication. When configuring this node to use two-factor authentication with an on-premises RADIUS server, you must enter the correct route the Unified Access Gateway instances can use to reach the RADIUS server. For example, if your on-premises RADIUS server uses 10.10.60.20 as its IP address, you would enter 10.10.60.0/24 and your default route gateway address as a custom route. You obtain your default route gateway address from the Express Route or VPN configuration you are using for this environment. Specify the custom routes as a comma-separated list in the form ipv4-network-address/bits ipv4-gateway-address, for example: 192.168.1.0/24 192.168.0.1, 192.168.2.0/24 192.168.0.2. Optionally specify custom routes to additional gateways that you want the deployed Unified Access Gateway instances to use to resolve network routing for the end user access. The specified routes are used to allow Unified Access Gateway to resolve network routing such as to RADIUS servers for two-factor authentication. Unified Access GatewayUnified Access GatewayWhen configuring this node to use two-factor authentication with an on-premises RADIUS server, you must enter the correct route the Unified Access Gateway instances can use to reach the RADIUS server. For example, if your on-premises RADIUS server uses 10.10.60.20 as its IP address, you would enter 10.10.60.0/24 and your default route gateway address as a custom route. You obtain your default route gateway address from the Express Route or VPN configuration you are using for this environment. Unified Access GatewaySpecify the custom routes as a comma-separated list in the form ipv4-network-address/bits ipv4-gateway-address, for example: 192.168.1.0/24 192.168.0.1, 192.168.2.0/24 192.168.0.2. ipv4-network-address/bits ipv4-gateway-addressCertificateCertificateCertificateUpload the certificate in PEM format that Unified Access Gateway will use to allow clients to trust connections to the Unified Access Gateway instances running in Microsoft Azure. The certificate must be based on the FQDN you entered and be signed by a trusted CA.Upload the certificate in PEM format that Unified Access Gateway will use to allow clients to trust connections to the Unified Access Gateway instances running in Microsoft Azure. The certificate must be based on the FQDN you entered and be signed by a trusted CA.Unified Access GatewayUnified Access GatewayThe following screenshot is an example with the fields completed. If you do not want to configure the end users' desktops to use RADIUS two-factor authentication, you can click Validate & Proceed to continue to the summary step. Validate & ProceedConfigure the end-user desktops to use RADIUS two-factor authentication by using the following steps. Select Yes for the Enable 2 Factor Authentication? toggle. When the toggle is set to Yes, the wizard displays the additional configuration fields. Use the scroll bar to access all of the fields. The following screenshot is an example of what is displayed after you set the toggle to Yes. Select Yes for the Enable 2 Factor Authentication? toggle. YesEnable 2 Factor Authentication?When the toggle is set to Yes, the wizard displays the additional configuration fields. Use the scroll bar to access all of the fields. YesThe following screenshot is an example of what is displayed after you set the toggle to Yes. YesSelect your two-factor authentication method in the drop-down list. In this release, RADIUS authentication is supported. Select your two-factor authentication method in the drop-down list. In this release, RADIUS authentication is supported. In the Name field, enter an identifying name for this configuration. In the Name field, enter an identifying name for this configuration. NameIn the Properties section, specify details related to the end users' interaction with the login screen they will use to authenticate for access. Option Description Display Name Optionally provide a name that the system will display to the end users on the Horizon Cloud login screen to identify which RADIUS system they are using to authenticate for access. Display Hint Optionally enter a text string that the system will display in the message on the login screen to direct users to enter the correct RADIUS passcode. Name ID Suffix Optionally enter a text string such as a domain name that you want appended to the user's name before it is sent to the authentication server. For example, when you want a user to type user1 into the login screen, but you want the system to send user1@example.com to the authentication server, you would enter @example.com into this field. Number of Iterations Enter the maximum number of failed authentication attempts that a user is allowed when attempting to log in using this RADIUS system. Maintain Username Select Yes to maintain the user's RADIUS username during authentication to Horizon Cloud. When Yes is selected: The user must have the same username credentials for RADIUS as for their Active Directory authentication to Horizon Cloud. The user cannot change the username in the login screen. If you select No, the user is able to type a different user name in the login screen. In the Properties section, specify details related to the end users' interaction with the login screen they will use to authenticate for access. OptionOptionDescriptionDescriptionDisplay NameDisplay NameDisplay NameOptionally provide a name that the system will display to the end users on the Horizon Cloud login screen to identify which RADIUS system they are using to authenticate for access.Optionally provide a name that the system will display to the end users on the Horizon Cloud login screen to identify which RADIUS system they are using to authenticate for access.Horizon CloudDisplay HintDisplay HintDisplay HintOptionally enter a text string that the system will display in the message on the login screen to direct users to enter the correct RADIUS passcode.Optionally enter a text string that the system will display in the message on the login screen to direct users to enter the correct RADIUS passcode.Name ID SuffixName ID SuffixName ID SuffixOptionally enter a text string such as a domain name that you want appended to the user's name before it is sent to the authentication server. For example, when you want a user to type user1 into the login screen, but you want the system to send user1@example.com to the authentication server, you would enter @example.com into this field. Optionally enter a text string such as a domain name that you want appended to the user's name before it is sent to the authentication server. For example, when you want a user to type user1 into the login screen, but you want the system to send user1@example.com to the authentication server, you would enter @example.com into this field. user1user1@example.comNumber of IterationsNumber of IterationsNumber of IterationsEnter the maximum number of failed authentication attempts that a user is allowed when attempting to log in using this RADIUS system.Enter the maximum number of failed authentication attempts that a user is allowed when attempting to log in using this RADIUS system.Maintain UsernameMaintain UsernameMaintain UsernameSelect Yes to maintain the user's RADIUS username during authentication to Horizon Cloud. When Yes is selected: The user must have the same username credentials for RADIUS as for their Active Directory authentication to Horizon Cloud. The user cannot change the username in the login screen. If you select No, the user is able to type a different user name in the login screen. Select Yes to maintain the user's RADIUS username during authentication to Horizon Cloud. When Yes is selected: YesHorizon CloudYesThe user must have the same username credentials for RADIUS as for their Active Directory authentication to Horizon Cloud. The user must have the same username credentials for RADIUS as for their Active Directory authentication to Horizon Cloud. Horizon CloudThe user cannot change the username in the login screen. The user cannot change the username in the login screen. If you select No, the user is able to type a different user name in the login screen. NoIn the Primary Server section, specify details about the authentication server. Option Description Host Name / IP Address Enter the DNS name or the IP address of the authentication server. Shared Secret Enter the secret for communicating with the authentication server. The value must be identical to the server-configured value. Authentication Port Specify the UDP port configured on the authentication server for sending or receiving authentication traffic. The default is 1812. Accounting Port Optionally specify the UDP port configured on the authentication server for sending or receiving accounting traffic. The default is 1813. Mechanism Select the authentication protocol that is supported by the specified authentication server and which you want the deployed node to use. Server Timeout Specify the number of seconds that the node should wait for a response from the authentication server. After this number of seconds, a retry is sent if the server does not respond. Max Number of Retries Specify the maximum number of times the node should retry failed requests to the authentication server. Realm Prefix Optionally provide a string which the system will place at the beginning of the user name when the name is sent to the authentication server. The user account location is called the realm. For example, if the user name is entered as user1 on the login screen and a realm prefix of DOMAIN-A\ was specified here, the system sends DOMAIN-A\user1 to the authentication server. If you do not specify a realm prefix, only the entered user name is sent. Realm Suffix Optionally provide a string which the system will append to the user name when the name is sent to the authentication server. For example, if the user name is entered as user1 on the login screen and a realm suffix of @example.com was specified here, the system sends user1@example.com to the authentication server. In the Primary Server section, specify details about the authentication server. OptionOptionDescriptionDescriptionHost Name / IP AddressHost Name / IP AddressHost Name / IP AddressEnter the DNS name or the IP address of the authentication server.Enter the DNS name or the IP address of the authentication server.Shared SecretShared SecretShared SecretEnter the secret for communicating with the authentication server. The value must be identical to the server-configured value.Enter the secret for communicating with the authentication server. The value must be identical to the server-configured value.Authentication PortAuthentication PortAuthentication PortSpecify the UDP port configured on the authentication server for sending or receiving authentication traffic. The default is 1812.Specify the UDP port configured on the authentication server for sending or receiving authentication traffic. The default is 1812.Accounting PortAccounting PortAccounting PortOptionally specify the UDP port configured on the authentication server for sending or receiving accounting traffic. The default is 1813.Optionally specify the UDP port configured on the authentication server for sending or receiving accounting traffic. The default is 1813.MechanismMechanismMechanismSelect the authentication protocol that is supported by the specified authentication server and which you want the deployed node to use.Select the authentication protocol that is supported by the specified authentication server and which you want the deployed node to use.Server TimeoutServer TimeoutServer TimeoutSpecify the number of seconds that the node should wait for a response from the authentication server. After this number of seconds, a retry is sent if the server does not respond.Specify the number of seconds that the node should wait for a response from the authentication server. After this number of seconds, a retry is sent if the server does not respond.Max Number of RetriesMax Number of RetriesMax Number of RetriesSpecify the maximum number of times the node should retry failed requests to the authentication server.Specify the maximum number of times the node should retry failed requests to the authentication server.Realm PrefixRealm PrefixRealm PrefixOptionally provide a string which the system will place at the beginning of the user name when the name is sent to the authentication server. The user account location is called the realm. For example, if the user name is entered as user1 on the login screen and a realm prefix of DOMAIN-A\ was specified here, the system sends DOMAIN-A\user1 to the authentication server. If you do not specify a realm prefix, only the entered user name is sent. Optionally provide a string which the system will place at the beginning of the user name when the name is sent to the authentication server. The user account location is called the realm. For example, if the user name is entered as user1 on the login screen and a realm prefix of DOMAIN-A\ was specified here, the system sends DOMAIN-A\user1 to the authentication server. If you do not specify a realm prefix, only the entered user name is sent. user1DOMAIN-A\DOMAIN-A\user1Realm SuffixRealm SuffixRealm SuffixOptionally provide a string which the system will append to the user name when the name is sent to the authentication server. For example, if the user name is entered as user1 on the login screen and a realm suffix of @example.com was specified here, the system sends user1@example.com to the authentication server.Optionally provide a string which the system will append to the user name when the name is sent to the authentication server. For example, if the user name is entered as user1 on the login screen and a realm suffix of @example.com was specified here, the system sends user1@example.com to the authentication server.user1user1@example.comIn the Secondary Server section, optionally specify details about an auxiliary authentication server. You can configure a secondary authentication server to provide for high availability. Set the Auxiliary Server toggle to Yes and complete the fields as described for the Step e. Auxiliary ServerYesStep eClick Validate & Proceed. When you click Validate & Proceed, the system verifies the validity and appropriateness of your specified values, such as: Are the subnets valid and non-overlapping with other networks in the selected region within your subscription. Are there enough virtual machine (VM) and cores in your subscription's quota to build out the node. Is the certificate in the correct PEM format. If you see an error message about overlapping networks, verify whether you have existing subnets using the same values already in your subscription. If everything validates OK, the summary page displays. Click Validate & Proceed. Validate & ProceedWhen you click Validate & Proceed, the system verifies the validity and appropriateness of your specified values, such as: Validate & ProceedAre the subnets valid and non-overlapping with other networks in the selected region within your subscription. Are the subnets valid and non-overlapping with other networks in the selected region within your subscription. Are there enough virtual machine (VM) and cores in your subscription's quota to build out the node. Are there enough virtual machine (VM) and cores in your subscription's quota to build out the node. Is the certificate in the correct PEM format. Is the certificate in the correct PEM format. If you see an error message about overlapping networks, verify whether you have existing subnets using the same values already in your subscription. If everything validates OK, the summary page displays. Review the summarized information and click Submit The system starts deploying the node into your Microsoft Azure environment. Review the summarized information and click Submit SubmitThe system starts deploying the node into your Microsoft Azure environment. ResultsDeploying the node can take up to an hour. Until the node is successfully deployed, a progress icon is displayed for that node. You might need to refresh the screen in your browser to see the updating progress. Important:When deploying additional nodes in Microsoft Azure China cloud, the process can take longer than an hour to complete. The process is subject to geographic network issues that can cause slow download speeds as the binaries are downloaded from the cloud control plane. What to do nextIf you specified RADIUS two-factor authentication for the end users' desktops from this node, you must configure your RADIUS system with the node's Unified Access Gateway load balancer public IP address as a client allowed to make requests of that RADIUS system. The node's Unified Access Gateway instances authenticate requests from the RADIUS system through that address. Unified Access GatewayUnified Access GatewayIf you specified to have Internet-enabled desktops, ensure you have a CNAME record in your DNS server to map the auto-generated public FQDN of the node's deployed load balancer to the FQDN that you entered in the deployment wizard. See Obtain the FQDN of the Node's Load Balancer to Map in your DNS Server for details. Obtain the FQDN of the Node's Load Balancer to Map in your DNS ServerParent topic:Managing Your Horizon Cloud NodesVMware, Inc x 